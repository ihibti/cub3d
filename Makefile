# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: gchenot <gchenot@student.42.fr>            +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2024/09/20 12:18:40 by gchenot           #+#    #+#              #
#    Updated: 2024/09/26 18:20:02 by gchenot          ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

# **************************************************************************** #
#                                   PROGRAM                                    #
# **************************************************************************** #

NAME = cub3D

# **************************************************************************** #
#                                   COMPILER                                   #
# **************************************************************************** #

CC = cc
CFLAGS = -Wall -Werror -Wextra
CFLAGS += -MMD -g3 -O3 -ffast-math -I./include

# **************************************************************************** #
#                                    PATHS                                     #
# **************************************************************************** #

LIBFTDIR = ./libft
MLXDIR = ./minilibx-linux
MLXFLAG = -L$(MLXDIR) -lmlx -L/usr/lib -lXext -lX11 -lm

# **************************************************************************** #
#                                   SOURCES                                    #
# **************************************************************************** #

FILES = $(addsuffix .c, \
		main)

FILES += $(addprefix algo/, $(addsuffix .c, \
		algorithms))

FILES += $(addprefix controls/, $(addsuffix .c, \
		controls \
		controls_secu \
		controls_slide \
		controls_utils))

FILES += $(addprefix free/, $(addsuffix .c, \
		free \
		free_utils))

FILES += $(addprefix hooks/, $(addsuffix .c, \
		hooks_moves))

FILES += $(addprefix init/, $(addsuffix .c, \
		init \
		init_utils))

FILES += $(addprefix map/, $(addsuffix .c, \
		create_map))

FILES += $(addprefix minimap/, $(addsuffix .c, \
		minimap \
		minimap_utils))

FILES += $(addprefix mlx/, $(addsuffix .c, \
		init_mlx))

FILES += $(addprefix parsing/, $(addsuffix .c, \
		parsing \
		parsing_colors \
		parsing_textures \
		parsing_textures_utils \
		parsing_map \
		parsing_map_supersaiyan3 \
		parsing_utils \
		parsing_utils2))

FILES += $(addprefix raycasting/, $(addsuffix .c, \
		raycasting \
		raycasting_textures \
		raycasting_utils))

FILES += $(addprefix utils/, $(addsuffix .c, \
		utils))

SRCS_DIR := ./src
OBJS_DIR := ./poubelle

SRCS := $(addprefix $(SRCS_DIR)/, $(FILES))
OBJS := $(addprefix $(OBJS_DIR)/, $(FILES:.c=.o))
DEPS := $(OBJS:.o=.d)

HEADERS := ./include

# List of subdirectories in which to create object files
OBJ_SUBDIRS := $(sort $(dir $(OBJS)))

# **************************************************************************** #
#                                    RULES                                     #
# **************************************************************************** #

all : $(NAME)

$(NAME): $(OBJS)
	@make --silent -C ${LIBFTDIR}
	@make --silent -C ${MLXDIR}
	@$(CC) -I$(HEADERS) -I$(MLXDIR) -o $@ $(OBJS) -L$(LIBFTDIR) -lft $(MLXFLAG) $(LDFLAG) $(CFLAGS)
	@printf "$(RED)"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠹⢿⡿⠏⢻⢿⠉⣿⣰⡟⠈⠘⠀⠀⠀⠀⠀⠰⠁⠘⠀⠘⠀⣿⠏⠀⢸⠃⢁⡛⣼⣿⣿⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿"
	@echo "⣿⣿⣿⣯⣿⣿⣿⠿⣿⣿⣿⡽⠝⢿⣿⡄⠘⠃⠀⠟⠀⠀⠘⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠀⠀⠁⠀⠀⢁⡟⢃⠁⣻⣿⡿⣿⡏⣼⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢿"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣧⡀⢻⣿⠇⠀⠈⠃⠇⢀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠀⠀⢧⠙⢐⣿⣿⡿⣻⣿⣿⣿⣿⣿⣿⣿⣿⣿⢏⠔⣹"
	@echo "⣿⣿⣿⣿⣿⡟⢿⡈⠑⡀⠂⠀⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠀⠀⠀⠀⠀⠀⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⠀⣼⡟⡻⣷⣿⣿⣿⣿⣿⣿⣿⣿⡿⠣⢁⣮⡟"
	@echo "⣿⣿⣿⣿⣿⣦⡕⢷⢁⠀⠐⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⠀⠀⠠⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⢀⣿⢋⣾⣿⣿⣿⣿⣿⣿⡟⡀⠁⣶⠋⠀"
	@echo "⣿⣿⣟⢿⢿⣷⣕⣌⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⠁⣽⢯⣾⣿⣿⣿⡟⡴⠰⠗⠸⠁⠀⠀"
	@echo "⣏⠿⣿⡧⡀⠢⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⠀⢀⠀⠀⠀⠀⠀⠀⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣬⣿⣿⣿⣿⢸⡇⡻⡁⠀⠀⠀⠀"
	@echo "⣿⢧⠈⣿⠘⠀⠀⠀⠀⠀⠀⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠄⠀⡠⠂⠀⠀⠀⠀⠀⠀⠁⠐⠀⠀⡀⠤⠀⠀⠀⠀⠀⠀⠉⠈⠀⠁⢀⠤⠀⠀⠘⠏⢸⢏⣽⣿⣞⢡⠃⡀⠀⠄⠀⠀"
	@echo "⣿⡆⠀⠈⠅⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠀⠀⠄⡤⠆⠀⠀⠀⢠⠀⢀⠂⠀⠀⠀⠀⠀⠀⢀⠀⠀⢀⡀⠀⠀⠄⠀⠀⠀⠀⠀⢠⣄⠀⠰⢫⣿⣿⣿⣿⠁⠀⠀⠀⠀⠀⠀"
	@echo "⣿⣮⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠜⠀⠀⠀⠀⠂⠂⠀⠀⠀⠀⠀⠀⠂⠀⠐⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⠋⠀⠀⠀⢰⢷⠿⡿⡄⠀⠀⠀⠀⠀⠀⠀"
	@echo "⠉⠉⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⠀⠀⡇⠠⢠⠋⠀⠀⠀⠀⠆⠀⢠⣴⣾⣿⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⠏⠠⠈⡄⠀⠘⢈⢰⢃⡌⠀⠀⠀⠀⠀⠀⠀"
	@echo "⣷⣢⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⡠⢠⢃⣀⡾⠀⠀⠀⠀⠃⢀⣴⣿⣿⡿⠛⠀⢀⣀⣠⢤⡄⢀⣀⣀⠀⠀⠄⠀⠀⢀⠀⠀⠚⠀⠀⠀⠻⡀⠸⠘⠘⠀⠀⠀⠀⠀⠀⠀⠀⠀"
	@echo "⡥⠂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠁⠇⠀⡂⠁⠀⠀⠀⠀⠁⠀⣿⡿⠟⠉⢀⡴⢚⣋⡩⠅⡀⡀⡀⠉⠉⠙⠀⠀⡀⠑⠄⠀⠀⠀⠀⢠⡄⣠⡇⠀⠀⠀⠀⠀⠀⠠⠀⠀⠀⠀⠀"
	@echo "⠤⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡀⠀⠈⠢⠀⠂⠁⠀⠀⠀⠠⢄⠀⠀⠋⠀⠀⣠⣤⣶⣿⣮⣭⣗⣺⠶⠶⠦⣤⣄⡂⠀⠈⠤⠀⠂⠀⠀⡫⡀⠈⠁⠀⠀⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"
	@echo "⣿⣤⣍⠑⠀⠀⠀⠀⠀⠀⠀⠤⣤⠐⠀⠀⠁⠀⠀⠀⡀⠔⡈⠐⢐⠂⢀⣠⣾⣿⣿⣿⣿⣿⣿⣿⡟⠻⢫⠔⣤⡉⠻⣄⢄⠀⠀⠀⠁⠐⠀⠀⠀⡈⠀⠀⢀⠠⡀⠀⠀⠀⠀⠀⠀⠀⠀"
	@echo "⣟⣃⣀⠀⠀⠀⠀⠀⠀⢰⠔⠊⠋⠀⠀⠀⢀⢠⡠⢄⣨⣵⡴⠪⠴⡾⠿⠛⢿⣿⣟⡛⡛⠛⡭⠛⢛⡷⢦⡁⠈⠙⡢⡈⠑⢄⠠⠀⡀⠐⡀⠀⠀⠀⠀⠀⠸⣧⡱⠀⠀⠀⠀⠀⠀⠀⠀"
	@echo "⣷⣶⣁⣤⡠⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⣴⣤⣈⣙⣛⣁⣀⡁⠁⣤⣶⣾⣿⣿⣿⡿⠆⠂⠀⠀⠀⠈⠑⠪⠳⣄⠈⠂⣀⠈⠳⣔⠔⠀⠐⠀⠀⠀⠀⠁⠀⠹⣷⣷⠆⠀⠀⠀⠀⠀⠀"
	@echo "⣿⣿⣿⣯⡤⠤⠀⠀⠀⠀⢀⣀⠤⣄⣤⡸⣿⡿⡏⢉⠉⠉⠉⢀⣸⣿⣿⠿⠟⠛⢁⣄⡀⠠⡠⡀⠀⠀⠀⢠⠐⠢⡑⡄⡈⠡⡀⠈⢎⠁⠀⢣⠐⡈⠀⠀⠀⠀⠘⡏⠀⠀⠀⠀⠀⠠⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣶⡀⠀⠀⣤⣶⣿⠟⠁⠀⠰⡑⠌⠁⠀⠒⠾⢿⡿⠛⣁⠌⣠⣤⣜⢿⣿⡆⠊⢪⣦⠑⠄⠀⠁⠈⠈⠪⣠⠂⡈⢀⠈⢢⢦⡡⢣⠡⠀⠀⣿⡄⢀⠡⠀⠀⠀⠀⠀⠀⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣋⣀⠀⢐⡻⡇⠰⠐⣠⣧⠡⠀⠄⢀⢀⠔⠁⠀⣠⣵⣦⡻⣿⣿⡦⠙⠮⢂⡁⠈⠀⠀⠀⠀⠀⠀⠢⠈⠩⠢⣀⠡⡀⢣⠀⠀⢂⠄⠀⠘⣷⡄⠀⠀⠀⠀⠀⠀⠀⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣶⣿⣷⣌⠉⠰⣰⣱⣿⡏⠀⣾⣾⠟⠁⠀⣠⣄⢿⣿⣿⣷⠈⠛⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⢮⣦⡑⠠⢣⠀⢀⠈⠀⠀⠠⠇⠀⠀⠀⠀⠀⠀⠀⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⠀⠅⣿⣿⡇⠰⣿⠁⠀⢄⡸⣿⣿⣦⠙⠃⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡄⠀⠑⢄⢻⣯⡀⠈⢆⡀⠀⠀⠀⠀⠄⠀⠀⠀⠀⠀⠀⠀⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⠀⠿⣿⠇⠁⠃⠀⠀⢸⣷⡝⠟⠦⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠀⠀⣀⣄⠁⠈⣥⡀⠐⠠⠙⣿⡀⠀⠆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⡀⠛⢈⠄⡀⠀⠀⢡⡻⠓⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠀⠠⡀⢔⣶⣿⣶⠊⢻⠁⠀⣤⣙⢢⠀⠀⠘⢯⡄⠈⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣄⠀⠢⠈⠀⠀⠀⠡⠂⠀⣀⡀⡀⠀⠀⠀⠢⡀⡀⠀⢄⢀⣼⣿⣿⣏⠀⢀⠀⢸⣭⡙⠷⡁⠀⠀⠀⢻⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣄⠀⠈⠢⠀⠀⠀⠁⠈⠁⠀⠀⠀⠈⠀⠨⣮⣶⣤⣿⣿⣿⣿⡷⠀⠀⢲⣭⣛⢿⡀⠗⠀⠀⠀⠐⡁⠀⠀⢀⠀⠀⠀⠀⠀⠀⠀⢠⢠⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣦⣀⠈⠐⠠⠀⠀⠀⠀⠀⠀⠀⠀⢢⣿⣿⣿⣿⣿⣿⠙⠁⠀⠀⣯⠻⣿⣷⡡⡀⠀⠀⢀⢁⠀⠀⠀⢈⠀⠀⠀⠀⠀⠀⠀⠀⡆⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣄⠀⠓⢄⠀⠀⠀⠀⠀⠀⠈⢿⣿⣿⡿⠛⢋⠂⢀⣄⠺⣿⣷⡘⣟⠃⠀⡀⠀⠠⠀⢀⠀⠀⠸⡀⠀⠀⠀⠀⠀⠀⠀⡇⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⣿⣿⣦⡀⠡⠀⢀⠀⠀⠐⢄⢄⡉⠁⠅⢀⣠⡐⢿⣿⣦⠈⢿⠇⢀⣀⢢⠁⠀⠄⠀⠀⠀⠀⠘⡇⡀⠀⠀⠀⠀⠀⢰⠀⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠛⢁⠙⣻⡿⠛⢛⣶⣄⠀⠀⡔⢄⠀⠳⣄⢆⡳⣤⡙⢿⣦⢙⠛⠈⢀⣴⣿⠿⠃⠀⠀⠀⠀⠂⠀⠀⢠⡇⠅⠀⠀⠀⠀⠀⡄⠀⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⣵⣿⣿⣿⣿⣿⣿⠃⠀⡌⡸⠟⠑⠀⢈⠁⠀⡰⢁⠈⢄⠃⢢⡈⠳⠝⢶⡩⠔⠉⢉⣤⣿⠿⠛⠁⠀⠀⣀⣴⡆⠨⠀⠀⠀⠀⡇⠀⠀⠀⠀⠀⠀⠃⠂⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣿⣿⠋⢰⠏⣽⣿⣿⣿⡿⡡⠀⠀⠀⠆⠃⠀⠀⢂⠀⠀⠃⠀⠀⠠⡙⢄⠝⢆⠀⠀⠁⢀⣴⡿⠟⠁⠀⠀⣀⣤⣼⣿⡿⠿⠀⠀⠀⠀⢀⢡⡌⠀⠀⠀⠀⠄⠀⠀⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣿⣿⠀⠀⡸⠏⣿⠋⢁⠄⠃⠀⠈⠀⠀⠀⠀⠀⠈⠀⠀⠀⠀⠀⠀⠀⠀⠁⠀⠁⠀⠀⠉⠁⠀⠀⠀⣀⣼⣿⠿⠻⠉⠃⠀⠀⠀⠀⠀⠈⣡⠀⠀⠀⠀⡸⠁⠀⠀⠀"
	@echo "⣿⣿⣿⣿⣿⣿⣿⣿⡟⠀⠀⠀⠀⠁⠀⠀⠀⠀⠀⠂⠀⠀⠀⡀⠀⠀⠀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣤⣿⢻⠋⢀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⡏⠀⠀⠀⠀⠁⠀⠀⠀⠀"
	@echo "⣿⣿⣿⣿⣿⣿⡟⡾⠟⡀⠀⠀⠀⠀⠀⠀⠈⠀⠀⠀⠀⠀⡀⠈⠢⣀⠀⠈⠀⢄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠑⠈⠻⢯⠀⠀⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⡠⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀"
	@echo "⣿⣿⣿⣿⣿⣿⡵⡀⠞⡁⢀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⠄⡀⠠⢀⠁⠠⢀⠀⠁⠂⠄⢂⠤⢀⠀⠀⠀⠀⠀⠈⠀⠀⠀⠀⠂⢄⡀⠀⠀⠀⠀⠀⠀⢠⠀⠀⠀⠀⢀⠀⠀⠀⠀⠀⠀"

# Create object directories
$(OBJS_DIR) $(OBJ_SUBDIRS):
	@mkdir -p $@

-include $(DEPS)

$(OBJS_DIR)/%.o: $(SRCS_DIR)/%.c | $(OBJ_SUBDIRS)
	@printf "$(LBLUE)[Compilation]$(RESET) In progress... $(GREEN)$<" && \
	$(CC) $(CFLAGS) -I$(HEADERS) -I$(MLXDIR) -c $< -o $@ && \
	printf "\r$(LBLUE)[Compilation]$(RESET) Completed   ... $(GREEN)$<" && \
	printf "\n"

clean:
	@make clean -C ${LIBFTDIR}
	@make clean -C ${MLXDIR}
	@rm -rf $(OBJS_DIR)

fclean: clean
	@make fclean -C ${LIBFTDIR}
	@rm -f $(NAME)

re: fclean all

run : ${NAME}
	@./${NAME} map.cub

val : ${NAME}
	@ valgrind --leak-check=full --show-leak-kinds=all --track-origins=yes ./${NAME} 2map.cub

vlog : ${NAME}
	@ valgrind --leak-check=full --show-leak-kinds=all --track-origins=yes --errors-for-leak-kinds=all --log-file=valgrind.log ./${NAME} map.cub

.PHONY: all clean fclean re val run

# **************************************************************************** #
#                                   COLORS                                     #
# **************************************************************************** #

GREEN   := \033[38;5;76m
RED     := \033[38;5;160m
YELLOW  := \033[38;5;226m
ORANGE  := \033[38;5;202m
PURPLE  := \033[38;5;213m
LBLUE   := \033[38;5;51m
BLUE    := \033[38;5;117m
INDI    := \033[38;5;99m
RESET   := \033[00m